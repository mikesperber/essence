(defprim-dynamic (make-stream m state)
  (delay
    (let ((o (m state)))
      (if (eq? #f o)
	  '()
	  (cons (car o)
		(make-stream m (cdr o)))))))

(defprim-dynamic (stream-car stream)
  (car (force stream)))

(defprim-dynamic (stream-cdr stream)
  (cdr (force stream)))

(defprim-dynamic (stream-empty? stream)
  (null? (force stream)))

(defprim-dynamic (list->stream l)
  (make-stream
   (lambda (l)
     (and (not (null? l))
	  l))
   l))
		
	 